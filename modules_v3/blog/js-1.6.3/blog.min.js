String.prototype.truncate=function(t){var e=new RegExp("^.{0,"+t+"}[\\S]*","g"),i=this.match(e),n=i[0].length;return i=i[0].replace(/\s$/,""),n<this.length?i+" â€¦":void 0};var blog=function(){function t(){return jQuery("body").on("click",".blog_block a",function(t){t.preventDefault();var e,n=jQuery(this),a=n.parents(".block").attr("id").split("_").shift(),r=n.closest(".blog_article"),l=r.length?r.attr("id").split("_").pop():null;switch(jQuery(this).attr("href")){case"#add":modalDialog(i.cmd+"edit&ctype="+a,i.title.replace("%s",i.add),i.width);break;case"#edit":modalDialog(i.cmd+"edit&ctype="+a+"&news_id="+l,i.title.replace("%s",i.edit),i.width);break;case"#delete":var d=jQuery("#blog_"+l).text().truncate(60);confirm(i.del+"\n\n"+d)&&jQuery.post(i.cmd+"delete",{csrf:WT_CSRF_TOKEN,news_id:l}).done(function(){window.location.reload()}).fail(function(){window.alert("Deletion failed")});break;case"#archive":e=jQuery(".blog_archive"),e.filter(":hidden").length?e.slideDown(function(){n.html(n.data("hide")).attr("title",n.data("hide"))}):e.slideUp(function(){n.html(n.data("view")).attr("title",n.data("view"))})}}),{init:function(t){i=i||t}}}var e,i;return{getInstance:function(){return e||(e=t()),e},version:"1.6.3"}}();
