<?xml version="1.0" encoding="UTF-8"?>
<Report>
<!-- $Id$ -->
	<Title><var var="i18n::translate('Descendancy Report')" /></Title>
	<Description>Prints a descendant chart in portrait mode</Description>
	<Input name="pid" lookup="INDI" type="text" default=""><var var="i18n::translate('Enter Individual ID')" /></Input>
	<Input name="maxgen" type="select" options="3=>3|4=>4|5=>5|6=>6|7=>7|8=>8|9=>9|*=>*"><var var="i18n::translate('Generations')" /></Input>
	<Input name="sources" type="checkbox" default="1"><var var="i18n::translate('Show sources?')" /></Input>
	<Input name="pageSize" type="select" default="A4" options="letter=>i18n::translate_c('paper size','Letter')|A3=>i18n::translate_c('paper size', 'A3')|A4=>i18n::translate_c('paper size','A4')|legal=>i18n::translate_c('paper size','Legal')"><var var="i18n::translate('Page size')" /></Input>
	<Input name="fonts" type="select" default="dejavusans" options="arialunicid0=>i18n::translate_c('font name', 'Arial')|dejavusans=>i18n::translate_c('font name', 'DejaVu')|helvetica=>i18n::translate_c('font name', 'Helvetica')"><var var="i18n::translate('Font')"/></Input>

	<!-- Header -->
	<Style name="header" font="$fonts" size="18"/>
	<!-- Page numbers text -->
	<Style name="pagenum" font="$fonts" size="8"/>
	<!-- Standard text -->
	<Style name="text" font="$fonts" size="9"/>
	<!-- Source text - FootnoteTexts - required style name by the generator -->
	<Style name="footnote" font="$fonts" size="8"/>
	<!-- Links to sources - required style name by the generator -->
	<Style name="footnotenum" font="$fonts" size="7"/>
	<!-- Generated by style - required style name by the generator -->
	<Style name="genby" font="$fonts" size="8" />
	<!-- Date text -->
	<Style name="date" font="$fonts" size="8"/>
	<Style name="subheader" font="$fonts" size="12" style="b" />
	<Style name="label1" font="$fonts" size="8"/>
	<Style name="label2" font="$fonts" size="10"/>
	<Style name="name" font="$fonts" size="9"/>
	<Style name="name1" font="$fonts" size="14"/>
	
	<SetVar name="personNumber" value="1" />
	<SetVar name="childNumber" value="2" />
	<SetVar name="generation" value="0" />
	<!-- New Page for Sources controller if SOUR exist -->
	<SetVar name="source_exist" value="0" />
	
	<Doc pageSize="$pageSize">
		<Header>
			<Cell align="center" height="30" newline="1" style="header"><var var="i18n::translate('Descendancy Report for ')" /><GetPersonName id="$pid" /></Cell>
			<Cell align="rightrtl" newline="1" style="pagenum"><var var="i18n::translate('Page')" /> <PageNum /> <var var="i18n::translate('of')" /> <TotalPages /></Cell>
		</Header>
		<Body>
			<Relatives id="$pid" group="descendants" sortby="generation" maxgen="$maxgen">
				<SetVar name="showPerson" value="F" />
				<RepeatTag tag="FAMS">
					<Gedcom id="@FAMS:@CHIL">
						<SetVar name="showPerson" value="T" />
					</Gedcom>
				</RepeatTag>
				<if condition="$showPerson=='T'">
					<if condition="$generation!=@generation">
						<Cell align="center" height="20" newline="1" style="subheader"><var var="i18n::translate('Generation ')" /> <Generation /></Cell>
						<SetVar name="generation" value="@generation" />
					</if>
					<TextBox border="" width="25" height="40">
						<Text style="name"><var var="personNumber" />.</Text>
					</TextBox>

					<TextBox border="" height="40" newline="1">
						<Text style="name"><GetPersonName id="" /> </Text>
<!-- main -->			<if condition="$sources==1">
							<RepeatTag tag="SOUR">
								<Footnote>
									<Gedcom id="@SOUR">
										<GedcomValue tag="TITL" />
									</Gedcom>
									<if condition="@PAGE!=''">: </if>
									<GedcomValue tag="SOUR:PAGE"/> <GedcomValue tag="SOUR:DATA:TEXT"/>
								</Footnote>
								<SetVar name="source_exist" value="1"/>
							</RepeatTag>
						</if>
						<SetVar name="printPeriod" value="false" />
						<if condition="@SEX=='M'">
							<SetVar name="gender" value="male" />
						</if>
						<if condition="@SEX=='F'">
							<SetVar name="gender" value="female" />
						</if>
						<SetVar name="birtExists" value="false" />
						<Gedcom id="BIRT">
							<SetVar name="birtExists" value="true" />	
							<SetVar name="printPeriod" value="true" />
							<if condition="$gender=='male'">
								<Text style="label1"> <var var="i18n::translate_c('MALE', 'was born')" /> </Text>
							</if>
							<if condition="$gender=='female'">
								<Text style="label1"> <var var="i18n::translate_c('FEMALE', 'was born')" /> </Text>
							</if>
							<if condition="$sources==1">
								<RepeatTag tag="BIRT:SOUR">
									<Footnote>
										<Gedcom id="@SOUR">
											<GedcomValue tag="TITL" />
										</Gedcom>
										<if condition="@PAGE!=''">: </if>
										<GedcomValue tag="PAGE" level="3"/> <GedcomValue tag="DATA:TEXT" level="3"/>
									</Footnote>
									<SetVar name="source_exist" value="1"/>
								</RepeatTag>
							</if>
							<if condition="@DATE!=''">
								<Text style="label1"> <var var=" " /> <GedcomValue tag="DATE" level="2" /></Text>
							</if>
							<if condition="@PLAC!=''">
								<Text style="label1"> <var var="i18n::translate(' in ')" /> <GedcomValue tag="PLAC" level="2" /></Text>
							</if>
						</Gedcom>
						<Gedcom id="DEAT">
							<SetVar name="printPeriod" value="true" />
							<if condition="$birtExists=='true'">
								<Text style="label1"> <var var="i18n::translate('and')" /></Text>
							</if>
							<if condition="$gender=='male'">
								<Text style="label1"> <var var="i18n::translate_c('MALE', 'died')" /> </Text>
							</if>
							<if condition="$gender=='female'">
								<Text style="label1"> <var var="i18n::translate_c('FEMALE', 'died')" /> </Text>
							</if>
							<if condition="$sources==1">
								<RepeatTag tag="DEAT:SOUR">
									<Footnote>
										<Gedcom id="@SOUR">
											<GedcomValue tag="TITL" />
										</Gedcom>
										<if condition="@PAGE!=''">: </if>
										<GedcomValue tag="PAGE" level="3"/> <GedcomValue tag="DATA:TEXT" level="3"/>
									</Footnote>
									<SetVar name="source_exist" value="1"/>
								</RepeatTag>
							</if>
							<if condition="@DATE!=''">
								<Text style="label1"> <var var=" " /> <GedcomValue tag="DATE" level="2" /></Text>
							</if>
							<if condition="@PLAC!=''">
								<Text style="label1"> <var var="i18n::translate(' in ')" /> <GedcomValue tag="PLAC" level="2" /></Text>
							</if>
						</Gedcom>
						<if condition="$printPeriod=='true'">
							<Text style="label1">.</Text>
						</if>
						<RepeatTag tag="FAMS">
							<SetVar name="printPronoun" value="$printPeriod" />
							<SetVar name="printPeriod" value="false" />
							<Gedcom id="@FAMS">
								<SetVar name="marrExists" value="false" />
								<if condition="$gender=='male'">
									<Gedcom id="MARR">
										<SetVar name="marrExists" value="true" />
										<if condition="$printPronoun=='true'" >
											<Text style="label1">  <var var="i18n::translate('He ')" /> </Text>
										</if>
										<SetVar name="printPeriod" value="true" />
										<Text style="label1"> <var var="i18n::translate('She ')" /> </Text>
										<if condition="$sources==1">
											<RepeatTag tag="MARR:SOUR">
												<Footnote>
													<Gedcom id="@SOUR">
														<GedcomValue tag="TITL" />
													</Gedcom>
													<if condition="@PAGE!=''">: </if>
													<GedcomValue tag="PAGE" level="3"/> <GedcomValue tag="DATA:TEXT" level="3"/>
												</Footnote>
												<SetVar name="source_exist" value="1"/>
											</RepeatTag>
										</if>
									</Gedcom>
									<if condition="$marrExists=='true'">
										<Gedcom id="@WIFE">
											<Text style="name"> <GetPersonName id="" /> </Text>
<!-- wife -->									<if condition="$sources==1">
													<RepeatTag tag="SOUR">
														<Footnote>
															<Gedcom id="@SOUR">
																<GedcomValue tag="TITL" />
															</Gedcom>
															<if condition="@PAGE!=''">: </if>
															<GedcomValue tag="SOUR:PAGE"/> <GedcomValue tag="SOUR:DATA:TEXT"/>
														</Footnote>
														<SetVar name="source_exist" value="1"/>
													</RepeatTag>
												</if>
											<Gedcom id="@FAMC">
												<Text style="label1"> <var var="i18n::translate('daughter of')" /></Text>
												<Text style="name"> <GetPersonName id="@HUSB" /> </Text>
												<Gedcom id="@HUSB">
													<Gedcom id="@FAMS:@WIFE">
														<Text style="label1"> <var var="i18n::translate('and')" /></Text>
													</Gedcom>
												</Gedcom>
												<Text style="name"> <GetPersonName id="@WIFE" /> </Text>
											</Gedcom>
										</Gedcom>
									</if>
								</if>
								<if condition="$gender=='female'">
									<Gedcom id="MARR">
										<SetVar name="marrExists" value="true" />
										<if condition="$printPronoun=='true'" >
											<Text style="label1">  <var var="i18n::translate('She ')" /> </Text>
										</if>
										<SetVar name="printPeriod" value="true" />
										<Text style="label1"> <var var="i18n::translate_c('FEMALE', 'married')" /> </Text>
										<if condition="$sources==1">
											<RepeatTag tag="MARR:SOUR">
												<Footnote>
													<Gedcom id="@SOUR">
														<GedcomValue tag="TITL" />
													</Gedcom>
													<if condition="@PAGE!=''">: </if>
													<GedcomValue tag="PAGE" level="3"/> <GedcomValue tag="DATA:TEXT" level="3"/>
												</Footnote>
												<SetVar name="source_exist" value="1"/>
											</RepeatTag>
										</if>
									</Gedcom>
									<if condition="$marrExists=='true'">
										<Gedcom id="@HUSB">
											<Text style="name"> <GetPersonName id="" /> </Text>
<!-- husband -->							<if condition="$sources==1">
												<RepeatTag tag="SOUR">
													<Footnote>
														<Gedcom id="@SOUR">
															<GedcomValue tag="TITL" />
														</Gedcom>
														<if condition="@PAGE!=''">: </if>
														<GedcomValue tag="SOUR:PAGE"/> <GedcomValue tag="SOUR:DATA:TEXT"/>
													</Footnote>
													<SetVar name="source_exist" value="1"/>
												</RepeatTag>
											</if>
											<Gedcom id="@FAMC">
												<Text style="label1"> <var var="i18n::translate('son of')" /></Text>
												<Text style="name"> <GetPersonName id="@HUSB" /></Text>
												<Gedcom id="@HUSB">
													<Gedcom id="@FAMS:@WIFE">
														<Text style="label1"> <var var="i18n::translate('and')" /></Text>
													</Gedcom>
												</Gedcom>
												<Text style="name"> <GetPersonName id="@WIFE" /></Text>
											</Gedcom>
										</Gedcom>
									</if>
								</if>
								<Gedcom id="MARR">
									<Text style="label1"> <var var=" " /></Text>
									<if condition="@DATE!=''">
										<SetVar name="printPeriod" value="true" />
										<Text style="label1"> <var var=" " /> <GedcomValue tag="DATE" level="2"/></Text>
									</if>
									<if condition="@PLAC!=''">
										<SetVar name="printPeriod" value="true" />
										<Text style="label1"> <var var="i18n::translate(' in ')" /> <GedcomValue tag="PLAC" level="2"/></Text>
									</if>
								</Gedcom>
								<if condition="$printPeriod=='true'">
									<Text style="label1">.</Text>
								</if>
								<if condition="$marrExists=='true'">
									<if condition="$gender=='male'">
										<Gedcom id="@WIFE">
											<SetVar name="printPeriod" value="false" />
											<SetVar name="birtExist" value="false" />
											<SetVar name="printPronoun" value="true" />
											<Gedcom id="BIRT">
												<if condition="$printPronoun=='true'">
													<SetVar name="printPeriod" value="true" />
													<Text style="label1">  <var var="i18n::translate('She ')" /></Text>
													<SetVar name="printPronoun" value="false" />
												</if>
												<SetVar name="birtExist" value="true" />
												<Text style="label1"> <var var="i18n::translate_c('FEMALE', 'was born')" /> </Text>
												<if condition="$sources==1">
													<RepeatTag tag="BIRT:SOUR">
														<Footnote>
															<Gedcom id="@SOUR">
																<GedcomValue tag="TITL" />
															</Gedcom>
															<if condition="@PAGE!=''">: </if>
															<GedcomValue tag="PAGE" level="3"/> <GedcomValue tag="DATA:TEXT" level="3"/>
														</Footnote>
														<SetVar name="source_exist" value="1"/>
													</RepeatTag>
												</if>
												<if condition="@DATE!=''">
													<Text style="label1"> <var var=" " /> <GedcomValue tag="DATE" level="2" /></Text>
												</if>
												<if condition="@PLAC!=''">
													<Text style="label1"> <var var="i18n::translate(' in ')" /> <GedcomValue tag="PLAC" level="2" /></Text>
												</if>
											</Gedcom>
											<Gedcom id="DEAT">
												<if condition="$printPronoun=='true'">
													<Text style="label1">  <var var="i18n::translate('She ')" /></Text>
													<SetVar name="printPronoun" value="false" />
												</if>
												<SetVar name="printPeriod" value="true" />
												<if condition="$birtExist=='true'">
													<Text style="label1"> <var var="i18n::translate('and')" /></Text>
												</if>
												<Text style="label1"> <var var="i18n::translate_c('FEMALE', 'died')" /> </Text>
												<if condition="$sources==1">
													<RepeatTag tag="DEAT:SOUR">
														<Footnote>
															<Gedcom id="@SOUR">
																<GedcomValue tag="TITL" />
															</Gedcom>
															<if condition="@PAGE!=''">: </if>
															<GedcomValue tag="PAGE" level="3"/> <GedcomValue tag="DATA:TEXT" level="3"/>
														</Footnote>
														<SetVar name="source_exist" value="1"/>
													</RepeatTag>
												</if>
												<if condition="@DATE!=''">
													<Text style="label1"> <var var=" " /> <GedcomValue tag="DATE" level="2" /></Text>
												</if>
												<if condition="@PLAC!=''">
													<Text style="label1"> <var var="i18n::translate(' in ')" /> <GedcomValue tag="PLAC" level="2" /></Text>
												</if>
											</Gedcom>
											<if condition="$printPeriod=='true'">
												<Text style="label1">.</Text>
											</if>
										</Gedcom>
									</if>
									<if condition="$gender=='female'">
										<Gedcom id="@HUSB">
											<SetVar name="printPronoun" value="true" />
											<SetVar name="printPeriod" value="false" />
											<SetVar name="birtExist" value="false" />
											<Gedcom id="BIRT">
												<SetVar name="printPeriod" value="true" />
												<if condition="$printPronoun=='true'">
													<Text style="label1">  <var var="i18n::translate('He ')" /></Text>
													<SetVar name="printPronoun" value="false" />
												</if>
												<SetVar name="birtExist" value="true" />
												<Text style="label1"> <var var="i18n::translate_c('MALE', 'was born')" /> </Text>
												<if condition="$sources==1">
													<RepeatTag tag="BIRT:SOUR">
														<Footnote>
															<Gedcom id="@SOUR">
																<GedcomValue tag="TITL" />
															</Gedcom>
															<if condition="@PAGE!=''">: </if>
															<GedcomValue tag="PAGE" level="3"/> <GedcomValue tag="DATA:TEXT" level="3"/>
														</Footnote>
														<SetVar name="source_exist" value="1"/>
													</RepeatTag>
												</if>
												<if condition="@DATE!=''">
													<Text style="label1"> <var var=" " /> <GedcomValue tag="DATE" level="2" /></Text>
												</if>
												<if condition="@PLAC!=''">
													<Text style="label1"> <var var="i18n::translate(' in ')" /> <GedcomValue tag="PLAC" level="2" /></Text>
												</if>
											</Gedcom>
											<Gedcom id="DEAT">
												<if condition="$printPronoun=='true'">
													<Text style="label1">  <var var="i18n::translate('He ')" /></Text>
													<SetVar name="printPronoun" value="true" />
												</if>
												<SetVar name="printPeriod" value="true" />
												<if condition="$birtExist=='true'">
													<Text style="label1"> <var var="i18n::translate('and')" /></Text>
												</if>
												<Text style="label1"> <var var="i18n::translate_c('MALE', 'died')" /> </Text>
												<if condition="$sources==1">
													<RepeatTag tag="DEAT:SOUR">
														<Footnote>
															<Gedcom id="@SOUR">
																<GedcomValue tag="TITL" />
															</Gedcom>
															<if condition="@PAGE!=''">: </if>
															<GedcomValue tag="PAGE" level="3"/> <GedcomValue tag="DATA:TEXT" level="3"/>
														</Footnote>
														<SetVar name="source_exist" value="1"/>
													</RepeatTag>
												</if>
												<if condition="@DATE!=''">
													<Text style="label1"> <var var=" " /> <GedcomValue tag="DATE" level="2" /></Text>
												</if>
												<if condition="@PLAC!=''">
													<Text style="label1"> <var var="i18n::translate(' in ')" /> <GedcomValue tag="PLAC" level="2" /></Text>
												</if>
											</Gedcom>
											<if condition="$printPeriod=='true'">
												<Text style="label1">.</Text>
											</if>
										</Gedcom>
									</if>
								</if>
							</Gedcom>
						</RepeatTag>
					</TextBox>

					<RepeatTag tag="FAMS">
						<Gedcom id="@FAMS">
							<if condition="@CHIL!=''">
								<SetVar name="numberOfChildren" value="0" />
								<RepeatTag tag="CHIL">
									<Gedcom id="@CHIL">
										<SetVar name="numberOfChildren" value="$numberOfChildren+1" />
									</Gedcom>
								</RepeatTag>

								<TextBox height="20" left="25" newline="1">
									<if condition="$numberOfChildren==1">
										<Text style="label1"><var var="i18n::translate('Child of ')" /></Text>
									</if>
									<if condition="$numberOfChildren>1">
										<Text style="label1"><var var="i18n::translate('Children of ')" /></Text>
									</if>
									<Text style="name"><GetPersonName id="@HUSB" /></Text>
									<Text style="label1"> <var var="i18n::translate('and')" /> </Text>
									<Text style="name"><GetPersonName id="@WIFE" /></Text>
									<Text style="label1">:</Text>
								</TextBox>

								<SetVar name="familyChildNumber" value ="1" />
								<RepeatTag tag="CHIL">
									<Gedcom id="@CHIL">
										<if condition="$familyChildNumber==1"><SetVar name="familyChildRoman" value="i" /></if>
										<if condition="$familyChildNumber==2"><SetVar name="familyChildRoman" value="ii" /></if>
										<if condition="$familyChildNumber==3"><SetVar name="familyChildRoman" value="iii" /></if>
										<if condition="$familyChildNumber==4"><SetVar name="familyChildRoman" value="iv" /></if>
										<if condition="$familyChildNumber==5"><SetVar name="familyChildRoman" value="v" /></if>
										<if condition="$familyChildNumber==6"><SetVar name="familyChildRoman" value="vi" /></if>
										<if condition="$familyChildNumber==7"><SetVar name="familyChildRoman" value="vii" /></if>
										<if condition="$familyChildNumber==8"><SetVar name="familyChildRoman" value="viii" /></if>
										<if condition="$familyChildNumber==9"><SetVar name="familyChildRoman" value="ix" /></if>
										<if condition="$familyChildNumber==10"><SetVar name="familyChildRoman" value="x" /></if>
										<if condition="$familyChildNumber==11"><SetVar name="familyChildRoman" value="xi" /></if>
										<if condition="$familyChildNumber==12"><SetVar name="familyChildRoman" value="xii" /></if>
										<if condition="$familyChildNumber==13"><SetVar name="familyChildRoman" value="xiii" /></if>
										<if condition="$familyChildNumber==14"><SetVar name="familyChildRoman" value="xiv" /></if>
										<if condition="$familyChildNumber==15"><SetVar name="familyChildRoman" value="xv" /></if>
										<if condition="$familyChildNumber==16"><SetVar name="familyChildRoman" value="xvi" /></if>
										<if condition="$familyChildNumber==17"><SetVar name="familyChildRoman" value="xvii" /></if>
										<if condition="$familyChildNumber==18"><SetVar name="familyChildRoman" value="xviii" /></if>
										<if condition="$familyChildNumber==19"><SetVar name="familyChildRoman" value="xix" /></if>
										<if condition="$familyChildNumber==20"><SetVar name="familyChildRoman" value="xx" /></if>
										<SetVar name="showChildNumber" value="false" />
										<RepeatTag tag="FAMS">
											<Gedcom id="@FAMS:@CHIL">
												<SetVar name="showChildNumber" value="true" />
											</Gedcom>
										</RepeatTag>
										<TextBox left="25" height="20" width="25">
											<if condition="$showChildNumber=='true'">
												<Text style="name"><var var="childNumber" />.</Text>
												<SetVar name="childNumber" value="$childNumber + 1" />
											</if>
										</TextBox>

										<TextBox height="20" newline="1">
											<Text style="label1"><var var="familyChildRoman" /></Text>
											<Text style="name">  <GetPersonName id="" /> </Text>
<!-- children -->							<if condition="$sources==1">
												<RepeatTag tag="SOUR">
													<Footnote>
														<Gedcom id="@SOUR">
															<GedcomValue tag="TITL" />
														</Gedcom>
														<if condition="@PAGE!=''">: </if>
														<GedcomValue tag="SOUR:PAGE"/> <GedcomValue tag="SOUR:DATA:TEXT"/>
													</Footnote>
													<SetVar name="source_exist" value="1"/>
												</RepeatTag>
											</if>
											<Gedcom id="BIRT">
												<Text style="label1"> <varLetter var="BIRT" />: <GedcomValue tag="DATE" level="2"/>  <GedcomValue tag="PLAC" level="2"/></Text>
											</Gedcom>
											<SetVar name="showMarraige" value="T" />
											<RepeatTag tag="FAMS">
												<Gedcom id="@FAMS:@CHIL">
												<SetVar name="showMarraige" value="F" />
												</Gedcom>
											</RepeatTag>
											<if condition="$showMarraige=='T'">
												<if condition="@SEX=='M'">
													<SetVar name="gender" value="male" />
												</if>
												<if condition="@SEX=='F'">
													<SetVar name="gender" value="female" />
												</if>
												<RepeatTag tag="FAMS">
													<Gedcom id="@FAMS">
														<Text style="label1"> <varLetter var="MARR" />: </Text>
														<if condition="$gender=='male'">
															<Text style="name"><GetPersonName id="@WIFE" /></Text>
														</if>
														<if condition="$gender=='female'">
															<Text style="name"><GetPersonName id="@HUSB" /></Text>
														</if>
														<Gedcom id="MARR">
															<if condition="@DATE!=''">
																<Text style="label1">, <GedcomValue tag="DATE" level="2" /></Text>
															</if>
															<if condition="@PLAC!=''">
																<Text style="label1">, <GedcomValue tag="PLAC" level="2" /></Text>
															</if>
														</Gedcom>
													</Gedcom>
												</RepeatTag>
											</if>
											<Gedcom id="DEAT">
												<Text style="label1"> <varLetter var="DEAT" />: <GedcomValue tag="DATE" level="2"/> <GedcomValue tag="PLAC" level="2"/></Text>
											</Gedcom>
										</TextBox>
									</Gedcom>
									<SetVar name="familyChildNumber" value="$familyChildNumber+1" />
								</RepeatTag>
							</if>
						</Gedcom>
					</RepeatTag>
					<SetVar name="personNumber" value="$personNumber + 1" />
					<TextBox height="10" newline="1" padding="0"/>
				</if>
			</Relatives>
			<if condition="($sources==1) and ($source_exist==1)">
				<NewPage/>
				<TextBox newline="1">
					<Text style="subheader"><var var="i18n::translate('Sources')" /><br /><br /></Text>
					<FootnoteTexts />
				</TextBox>
			</if>
		</Body>
		<Footer>
			<Cell align="rightrtl" newline="1" style="date"><Now /></Cell>
		</Footer>
	</Doc>
</Report>
